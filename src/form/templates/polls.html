{% extends 'base_template.html'%}

{% block 'titulo'%}
Desafio Economia Sensata
{% endblock%}

{% block 'body' %}
<br>

<div class="container">

    {% if status == '1'%}  
    <div class="alert alert-danger" role="alert">
        Todos os campos devem ser preenchidos!
    </div>
    {%endif%}
</div>

<div class="container">

    <div class="row ">
       
        <div class="col-md-6 offset-md-3">
            <br>
            <h1>Votações</h1>
            <hr>
                {% for i in polls %}
                <div class="card my-4 text-center">
                        <h5 class="card-header"><strong>{{i.country}} - {{i.form}}</strong></h5>
                        <div class="card-body">
                            <label class="mb-3 mr-5">
                            Deseja investir mais de 20% de seu orçamento em um ministério, o que você acha disso?
                            </label>
                            {%if i.owner and i.active and not i.coup %}
                            <label class="mb-3 mr-5">
                            Aguarde que todos os votos sejam computados.
                            </label>
                            {% endif%}
                            <br>
                             <div class="row justify-content-center">
                            {% if not i.owner and can_vote %}
                                <div class="col-4">
                                    <form  method="POST" action="{% url 'check_poll' %}"> {% csrf_token %}
                                        <input type="hidden" value="{{i.poll_id}}" name="poll_id">
                                        <input type="hidden" value="1" name="choice">
                                        <input class="btn btn-success btn-sm" type="submit" value="Aceitar" name="aceitar">
                                    </form>
                                </div>
                                <div class="col-4">
                                    <form  method="POST" action="{% url 'check_poll' %}"> {% csrf_token %}
                                        <input type="hidden" value="{{i.poll_id}}" name="poll_id">
                                        <input type="hidden" value="0" name="choice">
                                        <input class="btn btn-danger btn-sm" type="submit" value="Negar" name="negar">
                                    </form>
                                </div>
                            {% else %}
                                    <div class="col-4">
                                  
                                        {% if i.active %}
                                            <div class="btn btn-info btn-sm ">Em Votação!</div>
                                        {% elif i.result is True %}
                                            <div class="btn btn-success btn-sm ">Aprovado!</div>
                                        {% elif i.result is False %}
                                            <div class="btn btn-danger btn-sm ">Negado!</div>
                                        {% endif %}
                                    </div>
                            {% endif %}
                                </div>

                            <br/>
                        </div>
                </div>
                {% endfor %}
        </div>  
         
        <div class="col-md-6 my-5 offset-md-3">         
            <h1>Criar votação</h1>
            <hr>
            <form  method="POST" action="{% url 'create_poll' %}"> {% csrf_token %}
                <label for="fname">Escolha o ano que deseja criar a votação para teto de gastos:</label><br><br>
                <div class="row justify-content-center">
                    <div class="col-md-12">
                        <select name="form_name" class="form-control" aria-label="Default select example">
                            {% for i in forms %}
                                <option value={{i.value}}>{{i.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-info mt-3" name="criar" value=1 type="submit" style="width:100%">Criar</button>
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-danger mt-3" name="golpe" value=1 type="submit" style="width:100%">  Dar golpe</button>
                    </div>

                </div>
              
            </form>
        </div>
    </div>

</div>

{% endblock %}
